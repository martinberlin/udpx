<!--
Todos:

- With new design x starts in pixel 5, attempted to correct it 
  introducing xCorrection = 160
- Rest is working now, will introduce a color switching function later

-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Binary generator demo</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"
            type="text/javascript"></script>
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.1/build/pure-min.css"
          integrity="sha384-oAOxQR6DkCoMliIh8yFnu25d7Eq/PHS21PClpwjOTeU2jRSq11vu66rf90/cZr47" crossorigin="anonymous">
    <link rel="stylesheet" href="./style.css">
</head>
<body>
<div class="container" style="max-width:1000px; margin: 0 auto">
    <h4>Binary Generator for testing RGB(W) Stripes</h4>
    <form class="pure-form pure-form-stacked" id="main-form">
        <fieldset>
            <legend>
                Stripe
            </legend>
            <label for="rgb">
                <input type="radio" name="bytesPerPixel" value="rgb" id="rgb" checked/>
                RGB
            </label>
            <label for="rgbw">
                <input type="radio" name="bytesPerPixel" value="rgbw" id="rgbw"/>
                RGBW
            </label>
            <label for="esp32_ip">ESP32 IP:</label>
            <input id="esp32_ip" type="text" name="ip-adress" maxlength="15"
            value="192.168.0.96">
            <label for="udp_port">UDP Port:</label>
            <input id="udp_port" type="text" name="udp-port" maxlength="7"
            value="1234">
            <label for="protocol">Protocol:</label>
            <select id="protocol">
                <option value="pixels">Pixels</option>
                <option value="RGB888">RGB888</option>
            </select>
            
        </fieldset>
        <fieldset>
            <legend>Coloring</legend>
            <div id="colors">
            <input id="r" name="color-r" type="number" max="255" maxlength="3" value="155" placeholder="R">
            <input id="g" name="color-g"type="number" max="255" maxlength="3" value="0" placeholder="G">
            <input id="b" name="color-b"type="number" max="255" maxlength="3" value="0" placeholder="B">
            <input id="w" name="color-w"type="number" max="255" maxlength="3" value="0" placeholder="W">
            <label for="color_invert">
                <input type="checkbox" id="color_invert" name="color-invert"> Invert background
            </label>
            </div>
            <label for="stripe_length">Stripe length:</label>
            <input id="stripe_length" type="number" max="2999" maxlength="3" value="72" name="stripe-length">

            <label for="enable_hex">
                <input type="checkbox" name="enable_hex" id="enable_hex"> Enable HEX output (slower FPS)
            </label>
            <label for="background_random">
                <input type="checkbox" id="background_random" name="background_random"> Random colors in background
            </label>

            <br>For UDP please download this <a href="https://raw.githubusercontent.com/martinberlin/udpx/develop/examples/test/middleware.js">file</a> and run:<br>
            <pre>nodejs middleware.js</pre>
            
        </fieldset>
        <fieldset>
            <legend>Output</legend>
            <button type="button" id="btn2" class="pure-button">Reverse</button>
            <button type="button" id="btn1" class="pure-button pure-button-primary">Start</button>
            <button type="button" id="btn3" style="display: none">Test1</button>
            <span>Move 1</span>
            <button type="button" id="btnFirst">First</button>
            <button type="button" id="btnMinus">&lt;</button>
            <button type="button" id="btnPlus">&gt;</button>
            <button type="button" id="btnLast">Last</button>
            <div id="box" class="stripe-box">
                <div id="stripe"></div>
            </div>
        </fieldset>

        <fieldset>
            <legend>Settings</legend>

                Send method:

            <label for="http">
                <input type="radio" name="sending-mode" value="Http" id="http">
                HTTP
            </label>
            <label for="udp">
                <input type="radio" name="sending-mode" value="Udp" id="udp" checked>
                UDP
            </label>

            <label for="duration">
                    <input id="duration" name="duration" type="number" max="10" maxlength="2" value="5"> Duration
            </label>

            <button type="button" id="btnSaveFrame" class="pure-button">Save last sent frame as *.bin</button>

        </fieldset>



    <fieldset id="responsebox">
        <div id="bytes" style="float:right;margin-right: 5px"></div>
        <div id="millis" style="float:left;margin-left: 5px"></div>
    </fieldset>
    <fieldset id="box_out" class="fullwidth">
        <textarea id="out" rows="18" style="width: 100%">HEX Representation of binary data sent</textarea>
    </fieldset>
    </form> 

    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/latest/TweenMax.min.js"></script>
    <script src="./binary.js"></script>

    <script>
    function getPos(el) {
        var rect=el.getBoundingClientRect();
        return {x:rect.left,y:rect.top};
    }
    let stripePosition = getPos(document.getElementById('stripe'));
    let xCorrection = stripePosition.x;
    </script>
</div>
</body>
</html>
